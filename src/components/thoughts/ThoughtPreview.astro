---
import type { CollectionEntry } from 'astro:content';
import CategoryPills from '../layout/CategoryPills.astro';
import ReadTime from '../layout/ReadTime.astro';

interface Props {
  post: CollectionEntry<'thoughts'>;
}

const { post } = Astro.props;

// Defensive local values
const title = post?.data?.title ?? 'Untitled';
const description = post?.data?.description ?? '';
const readTime = Number(post?.data?.readTime ?? 0);
const categories = Array.isArray(post?.data?.categories) ? post.data.categories : [];
const slug = post?.slug ?? '';
---

<article>
  <ReadTime
    minutes={readTime}
    iconClass="h-5 w-5 text-black/50 dark:text-white/50"
    textClass="text-lg md:text-xl text-black/70 dark:text-white/70"
    textTag="span"
  />
  <h2 class="pb-3 pt-2 font-heading text-2xl-custom md:text-5xl font-black hover:text-black/60 dark:hover:text-white/60">
    <a href={`/thoughts/${slug}`}>{title}</a>
  </h2>
  {description && <p class="text-lg md:text-xl leading-tight">{description}</p>}
  {categories.length > 0 && (
    <CategoryPills
      categories={categories}
      basePath="/thoughts/category"
      variant="hashtags"
      wrapperClass="flex flex-wrap gap-x-6 gap-y-6 py-2 text-lg md:text-xl text-black/70 dark:text-white/70"
    />
  )}
</article>
